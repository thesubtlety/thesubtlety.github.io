<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.60.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>The Subtlety</title>
  <meta name="description" content="Indiscriminate Idiotropics on Infosec" />

  
  <link type="text/css" rel="stylesheet" href="https://www.thesubtlety.com/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://www.thesubtlety.com/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://www.thesubtlety.com/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://www.thesubtlety.com/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.thesubtlety.com/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://www.thesubtlety.com/favicon.png">

  
  <link href="https://www.thesubtlety.com/index.xml" rel="alternate" type="application/rss+xml" title="The Subtlety" />
  
</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://www.thesubtlety.com/"><h1>The Subtlety</h1></a>
      <p class="lead">
       Indiscriminate Idiotropics on Infosec 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://www.thesubtlety.com/">Home</a> </li>
        
      </ul>
    </nav>

    <p>&copy; 2019. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="posts">
<article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/2019-12-07-how-to-use-shodan-api-at-scale/">How to Use the Shodan API at Scale</a>
  </h1>
  <time datetime="2019-12-10T18:07:57-0800" class="post-date">Tue, Dec 10, 2019</time>
  This is a quick post mostly for refreshing my memory in the future. I recently wanted to download the data Shodan had on a large corporate IP space with disparate ranges and several hundred thousand IP addresses for post processing.
As far as I can tell the Shodan help docs are scattered across too many pages and domains and subdomains. There are a few guides out there on the basics of Shodan CLI and API but I didn't see anything that documented things at a slightly larger scale so here are a few quick notes on gathering this data.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/2019-12-07-how-to-use-shodan-api-at-scale/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/a-389-ds-pbkdf2-password-checker/">Brute Forcing 389-ds PBKDF2 Passwords</a>
  </h1>
  <time datetime="2019-09-23T20:52:14-0700" class="post-date">Mon, Sep 23, 2019</time>
  Several times now I've run across password hashes created by 389-ds, RedHat's open source LDAP Directory Server solution. During a red team past operation I discovered a backup LDIF file which included hashed user passwords (think NTDS.dit but not as catastrophic). A number of the hashes were in prepended with PBKDF2_SHA256.
While hashcat and john the ripper have support for most algorithms, they are at the moment lacking support for 389-ds's PBKDF2_SHA256 implementation.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/a-389-ds-pbkdf2-password-checker/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/empire-python-implant-on-windows/">Empire Python Implant on Windows</a>
  </h1>
  <time datetime="2019-08-29T16:40:37-0700" class="post-date">Thu, Aug 29, 2019</time>
  A while back I was playing around with Empire (before it was shuttered, RIP) and bypassing a certain antivirus software. There were decent signatures for the basic powershell usage, but knowing Python was installed on the target Windows endpoints, I tried to run the Empire Python payload on Windows. It didn't work. Turns out, it's trivial to get things working again.
If you generate a basic Python stager with stock Empire, we see an initial checkin to the server
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/empire-python-implant-on-windows/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/patching-boto3-useragent/">Monkeying Around: Patching the boto3 User-Agent</a>
  </h1>
  <time datetime="2019-02-16T16:32:17-0800" class="post-date">Sat, Feb 16, 2019</time>
  I was recently doing some testing in AWS with some &ldquo;obtained&rdquo; access keys. Part of this engagement was to identify some threshold at which the blue team was noticing and engaging with suspicious activity and as such we were running some automated tooling. In AWS this can mean bruteforcing services and creating quite a bit of logs.
After not so long we got a request asking if we were up to anything - success!
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/patching-boto3-useragent/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/2017-06-21-decrypting-jenkins2-credentials/">Decrypting Jenkins 2 Credentials</a>
  </h1>
  <time datetime="2017-06-21T23:07:11-0700" class="post-date">Wed, Jun 21, 2017</time>
  I like Jenkins. It's a good orchestration tool and provides remote code execution as a service.
If your user permissions give you access to the script console /script it's trivial to obtain a shell. The developers explicitly call this out in their documentation as well so it's a feature, not a bug. Of course if you can create a job you can run shell commands as well, but I'll leave that for another time.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/2017-06-21-decrypting-jenkins2-credentials/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/2017-04-19-using-katz-to-reflectively-load-exe/">Using subTee&#39;s katz to Reflectively Load an exe</a>
  </h1>
  <time datetime="2017-04-19T18:19:01-0700" class="post-date">Wed, Apr 19, 2017</time>
  I haven't seen this specifically outlined anywhere so I figured I'd write a short post to go over using subTee's Katz2.0 program to create a custom binary that loads mimikatz (or whatever executable you'd like) into memory. Casey Smith (subTee) and company have created some incredible tools that have made my life easier, so hats off to them.
Reflective Injection The following steps will create a custom binary with an encrypted and encoded mimikatz binary string which will load mimikatz into memory through reflective PE injection.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/2017-04-19-using-katz-to-reflectively-load-exe/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/2017-03-13-informacast-singlewire-insecure-jmx/">Informacast Singlewire Insecure JMX Config to RCE</a>
  </h1>
  <time datetime="2017-03-13T23:17:52-0700" class="post-date">Mon, Mar 13, 2017</time>
  I recently came across a good reminder to double check listening ephemeral ports. The organization in question was using the Informacast Singlewire Desktop Notifier v2.0 application. It allows organizations &ldquo;to display a pop-up window on top of other running applications to inform users of important information&rdquo; or to send desktop alerts to users in geographic regions.
After some enumeration, it looked like it was exposing a JMX Remote management port of we'll say port 42424.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/2017-03-13-informacast-singlewire-insecure-jmx/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/2017-02-11-osce-review/">The OSCE | Cracking the Perimeter Review</a>
  </h1>
  <time datetime="2017-02-11T13:05:48-0800" class="post-date">Sat, Feb 11, 2017</time>
  I recently took the CTP course by Offensive Security and passed the OSCE exam. Now there are a few dozen reviews on this thing, but I'll add my own take here anyway.
Pre Course You can't just register for the CTP - you need to solve a small challenge first: http://fc4.me/. When I initially thought about taking this course, part of this challenge was beyond me. But to quote g0tmi1k:
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/2017-02-11-osce-review/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/2017-01-25-query-shodan-and-censys-with-shocens/">Search Shodan and Censys With Shocens</a>
  </h1>
  <time datetime="2017-01-25T21:06:57-0800" class="post-date">Wed, Jan 25, 2017</time>
  Recon is close to step one in any pentest. When it comes to passively pulling data on infrastructure assets you have a number of options. ARIN can help identify an organization's registered net blocks, but that's only part of the picture. With many organizations based in or using cloud services, those assets won't necessarily be registered to your target.
And when AWS for example can tie directly into a datacenter, these servers become quite valuable.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/2017-01-25-query-shodan-and-censys-with-shocens/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/persistent-dnscat2/">Persistent C2 with dnscat2</a>
  </h1>
  <time datetime="2016-12-19T17:19:40-0800" class="post-date">Mon, Dec 19, 2016</time>
  Occasionally an environment has strict outbound rules with all traffic going through an authenticated proxy. This hampers exfiltration, especially if you don't currently have valid credentials but need a foothold into an environment without phishing for instance. If we can find a live network jack in some accessible place and the switch hands out an IP address via DHCP along with DNS servers, we can more than likely obtain a foothold into the network.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/persistent-dnscat2/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/opendnss-appsec-training-lab/">OpenDNS&#39;s AppSec Training Lab</a>
  </h1>
  <time datetime="2015-08-23T00:27:58Z" class="post-date">Sun, Aug 23, 2015</time>
  I came across OpenDNS Security Ninjas AppSec Training Lab not too long ago and found its simplicity rather enjoyable. It's a simple web app written in PHP which illustrates each of the OWASP Top 10 categories. As I was going through the exercises I found myself checking to see how the vulnerable code was written and how the issues could be remediated.
Since the lab is geared towards beginners, I thought it might be helpful to provide brief explanations along with links to the relevant lines of source code.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/opendnss-appsec-training-lab/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/the-oscp-penetration-testing-with-kali-linux/">The OSCP | Penetration Testing With Kali Linux</a>
  </h1>
  <time datetime="2014-12-20T22:03:29Z" class="post-date">Sat, Dec 20, 2014</time>
  I've spent the last few months working through the Penetration Testing with Kali Linux course by Offensive Security which has been an awesome learning experience.
Much has been said on this course and I'll only briefly go over my experience and takeaways. The following reviews were helpful in making the decision to take the course.
 Review by g0tmi1k Review by recrudesce Review from Buffered.io Review from IODigitalSec Review from SecuritySift   For a little preview of what's involved, check out the free [Metasploit Unleashed](http://www.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/the-oscp-penetration-testing-with-kali-linux/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/building-a-web-app-in-rails/">Building a Web App in Rails</a>
  </h1>
  <time datetime="2014-04-11T01:57:03Z" class="post-date">Fri, Apr 11, 2014</time>
  A brilliant software engineering friend and I were recently discussing with another mutual friend the inefficiencies of employees filling out paper forms after completion of a construction job and the inefficiencies of transferring said forms to excel and so on. Said friend and I figured we could probably fix this with a web app for a nominal fee, but which would greatly increase our mutual friends&rsquo; productivity. A win win situation if there ever was one.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/building-a-web-app-in-rails/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/renewing-your-startcom-ssl-cert/">Renewing your StartCom SSL Cert</a>
  </h1>
  <time datetime="2014-03-15T00:57:49Z" class="post-date">Sat, Mar 15, 2014</time>
  Since I've forgotten how to do this over the past year, here are the directions for posterity.
  Startcom sends you a reminder after 50 weeks and opens a window for a renewal. Log in and validate your email and domain using the Validation Wizard. Note, you need to ensure your email is going to forward properly.
  Generate a key and CSR on the server with the following two commands openssl genrsa -out .
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/renewing-your-startcom-ssl-cert/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/just-the-basics/">Just the Basics</a>
  </h1>
  <time datetime="2014-02-17T20:58:31Z" class="post-date">Mon, Feb 17, 2014</time>
  Things have been busy lately, but I've been doing some reading, learning, and playing around in a small VM lab, and thought to briefly document what I've done. There is unfortunately nothing groundbreaking here, and nothing too interesting beyond a demonstration.
___ ___ _ _ _ _ | \/ | | | | | (_)| | | . . | ___ | |_ __ _ ___ _ __ | | ___ _ | |_ | |\/| | / _ \| __|/ _` |/ __|| '_ \ | | / _ \ | || __| | | | || __/| |_| (_| |\__ \| |_) || || (_) || || |_ \_| |_/ \___| \__|\__,_||___/| .
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/just-the-basics/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/bsidesdc-badge/">BSidesDC Badge </a>
  </h1>
  <time datetime="2013-10-29T01:19:19Z" class="post-date">Tue, Oct 29, 2013</time>
  I recently attended my first security conference: BSidesDC. This isn't a write up of that experience, although it was quite interesting and I learned a lot via some great sessions. One talk I really enjoyed by @grecs was Malware Analysis 101. Very well presented with lots of great getting started material.
  Anyways, the badges. Pretty cool badges; bottle openers in fact, with fourteen binary bytes all with leading zeroes around the circumference: ascii encoded binary.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/bsidesdc-badge/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/security-onion-network-configuration-and-install/">Security Onion Network Configuration and Install</a>
  </h1>
  <time datetime="2013-10-19T02:41:57Z" class="post-date">Sat, Oct 19, 2013</time>
  With apologies to The Onion
  I've played around with Security Onion in the past, but have never set up my network to capture or monitor traffic. And while installing Security Onion in a VM and only looking at only local or inter-VM traffic is quite interesting, especially if a person is playing around with Metasploit or something, I wanted to see all network traffic, including my other devices.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/security-onion-network-configuration-and-install/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/kippo-on-the-raspberry-pi/">Kippo on the Raspberry Pi</a>
  </h1>
  <time datetime="2013-05-07T01:43:15Z" class="post-date">Tue, May 7, 2013</time>
  I recently bought a Raspberry Pi and installed Arch Linux ARM on it. I came across a rather amusing blog post of someone using the honeypot Kippo and thought what fun. See here to watch elite hackers and their mad skillz. That's the great thing about Kippo - it records user sessions for playback.
Anyways, this post basically walks through what I did to get Kippo and kippo-graph up and running on my RPi.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/kippo-on-the-raspberry-pi/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/career-readme-txt/">Career README.txt</a>
  </h1>
  <time datetime="2013-04-04T00:50:49Z" class="post-date">Thu, Apr 4, 2013</time>
  I read this article by Patrick McKenzie a while back, came across it again, and decided it's worth reading weekly. I've pulled out some of his bolded points. But seriously, read the article in it's entirety. Again. And again.
Don't Call Yourself a Programmer, And Other Career Advice
  Modesty is not a career enhancing character trait
  Network. In person.
  Learn how to negotiate
  Get good at Enterprise Sales
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/career-readme-txt/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/rob-fuller-on-getting-a-job-in-infosec/">Rob Fuller on Getting a Job in InfoSec</a>
  </h1>
  <time datetime="2013-02-22T01:12:37Z" class="post-date">Fri, Feb 22, 2013</time>
  I was fortunate enough to get a good job in IT right out of college. Not in InfoSec, but in telecom, and in specific, service delivery. I'm learning an incredible amount - from enterprise telephony environment to working in a highly complex work environment to leading delivery on new intent projects. But it's not InfoSec.
In my search for ways to break into InfoSec, I've come across numerous posts, advice, and tips to do just that.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/rob-fuller-on-getting-a-job-in-infosec/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/on-the-dumbest-ideas-in-computer-security/">On the Dumbest Ideas in Computer Security</a>
  </h1>
  <time datetime="2012-09-15T22:22:40Z" class="post-date">Sat, Sep 15, 2012</time>
  The other day I came across an article by Marcus J Ranum on the six dumbest ideas in computer security which were very simple yet struck me as profound. I'll summarize them here for future reference.
 Default Permit  Back when computer networks were still in their infancy, there were few avenues for attack. With those avenues turned off, all else was allowed. Hence &ldquo;default permit.&rdquo; Another area is code execution: anything clicked is permitted to run, unless stopped by antivirus or the likes.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/on-the-dumbest-ideas-in-computer-security/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/breaking-into-security/">Breaking into Security</a>
  </h1>
  <time datetime="2012-06-25T18:21:26Z" class="post-date">Mon, Jun 25, 2012</time>
  This blogging thing is harder than it seems - the what to write, the time to write. I came across another interesting blog post from Krebs on Security, who interviewed Thomas Ptackek, founder of Matasano Security, on how to get into the field of computer security. As this is precisely my intent, I gave it a quick read through and thought to post a to-do for myself.
  Learn how to program.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/post/breaking-into-security/">Read More…</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/post/random-ramblings/">My Random Ramblings</a>
  </h1>
  <time datetime="2012-01-04T21:12:53Z" class="post-date">Wed, Jan 4, 2012</time>
  Here, shall I attempt to document some random doings related to computers, security, linuxstuff, windowsstuff, and most likely miscellany.
Apparently typing all this out helps the mind become better at communicating, and who doesn't want that?
So whether you or another read these ramblings, or I myself re-read them later on in my ever so awe-inspiring, galvanic, exhilarating life, let this be a place for learning and perusing.
  
</article><article class="post">
  <h1 class="post-title">
    <a href="https://www.thesubtlety.com/about/">About</a>
  </h1>
  <time datetime="2012-01-01T00:00:00-0500" class="post-date">Sun, Jan 1, 2012</time>
  I am a security professional with over seven years of experience and have held roles troubleshooting large networks and securing web and mobile applications. For the last three years I have been red teaming at several Fortune 500s across multiple industries.
I have a strong track record of applying creative thinking and determination to solve technical challenges. I contribute to open source software including the Metasploit framework1 and enjoy sharing my technical learning experiences through this blog.
  
  <div class="read-more-link">
    <a href="https://www.thesubtlety.com/about/">Read More…</a>
  </div>
  
</article>
</div>
    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-29425132-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  </body>
</html>
